# ==============================================================================
# PlanProof Production Environment Configuration
# ==============================================================================
# 
# SECURITY NOTICE:
# - This file contains sensitive credentials
# - NEVER commit this file to version control
# - Keep it secure and restrict access
# - Rotate secrets regularly
#
# ==============================================================================

# ==============================================================================
# ENVIRONMENT
# ==============================================================================
ENVIRONMENT=production
HOSTNAME=planproof-prod-01

# ==============================================================================
# DATABASE (PostgreSQL + PostGIS)
# ==============================================================================
# Production database URL
# Format: postgresql://username:password@host:port/database?options
DATABASE_URL=postgresql://planproof_user:CHANGE_ME_STRONG_PASSWORD@prod-db.postgres.database.azure.com:5432/planproof?sslmode=require

# Connection pool settings (recommended for production)
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# ==============================================================================
# AZURE STORAGE (Blob Storage)
# ==============================================================================
# Azure Storage account connection string
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=CHANGE_ME;AccountKey=CHANGE_ME;EndpointSuffix=core.windows.net

# Container names
AZURE_STORAGE_CONTAINER_INBOX=inbox
AZURE_STORAGE_CONTAINER_ARTEFACTS=artefacts
AZURE_STORAGE_CONTAINER_LOGS=logs

# ==============================================================================
# AZURE DOCUMENT INTELLIGENCE
# ==============================================================================
AZURE_DOCINTEL_ENDPOINT=https://CHANGE_ME.cognitiveservices.azure.com/
AZURE_DOCINTEL_KEY=CHANGE_ME_32_CHAR_KEY

# DocIntel settings
DOCINTEL_USE_URL=true
DOCINTEL_PAGE_PARALLELISM=3
DOCINTEL_PAGES_PER_BATCH=10

# ==============================================================================
# AZURE OPENAI
# ==============================================================================
AZURE_OPENAI_ENDPOINT=https://CHANGE_ME.openai.azure.com/
AZURE_OPENAI_API_KEY=CHANGE_ME_32_CHAR_KEY
AZURE_OPENAI_API_VERSION=2024-02-15-preview
AZURE_OPENAI_CHAT_DEPLOYMENT=gpt-4

# LLM context limits (production optimized)
LLM_CONTEXT_MAX_CHARS=8000
LLM_CONTEXT_MAX_BLOCKS=100
LLM_FIELD_CONTEXT_MAX_CHARS=5000
LLM_FIELD_CONTEXT_MAX_BLOCKS=40

# ==============================================================================
# AZURE KEY VAULT (Secrets Management)
# ==============================================================================
# Use Azure Key Vault for secrets in production
AZURE_KEY_VAULT_NAME=planproof-prod-kv
# OR specify full URL:
# AZURE_KEY_VAULT_URL=https://planproof-prod-kv.vault.azure.net/

# ==============================================================================
# AUTHENTICATION & SECURITY
# ==============================================================================
# JWT Configuration (REQUIRED for production)
JWT_SECRET_KEY=CHANGE_ME_TO_A_STRONG_RANDOM_256_BIT_KEY
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=480

# API Keys (comma-separated list)
API_KEYS=CHANGE_ME_KEY_1,CHANGE_ME_KEY_2,CHANGE_ME_KEY_3

# CORS Origins (comma-separated list)
API_CORS_ORIGINS=https://planproof.yourdomain.com,https://app.yourdomain.com

# UI Authentication (username:password pairs, comma-separated)
# Note: Use strong passwords and consider external auth in production
UI_ALLOWED_USERS=admin:CHANGE_ME_STRONG_ADMIN_PASSWORD,officer1:CHANGE_ME_PASSWORD

# ==============================================================================
# LOGGING
# ==============================================================================
LOG_LEVEL=INFO
LOG_JSON=true

# File logging (optional)
LOG_FILE=/var/log/planproof/app.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================
ENABLE_EXTRACTION_CACHE=true
ENABLE_DB_WRITES=true
ENABLE_LLM_GATE=true

# ==============================================================================
# RETRY POLICY
# ==============================================================================
AZURE_RETRY_MAX_ATTEMPTS=5
AZURE_RETRY_BASE_DELAY_S=1.0

# ==============================================================================
# MONITORING & ALERTING
# ==============================================================================
# Azure Application Insights
APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=CHANGE_ME;IngestionEndpoint=https://REGION.in.applicationinsights.azure.com/

# Email alerts (SMTP)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASSWORD=CHANGE_ME_SENDGRID_API_KEY
ALERT_EMAIL_FROM=alerts@planproof.yourdomain.com
ALERT_EMAIL_TO=admin@yourdomain.com,oncall@yourdomain.com

# Webhook alerts (Slack, Teams, etc.)
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/CHANGE_ME/WEBHOOK_URL

# Alert thresholds
ALERT_MIN_SEVERITY=ERROR

# ==============================================================================
# PERFORMANCE & SCALING
# ==============================================================================
# API workers (gunicorn/uvicorn)
WEB_CONCURRENCY=4
WORKER_TIMEOUT=300
KEEPALIVE=5

# Rate limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# Cache settings
REDIS_URL=redis://planproof-cache.redis.cache.windows.net:6380?ssl=true&password=CHANGE_ME
CACHE_TTL_SECONDS=3600

# ==============================================================================
# BACKUP & DR
# ==============================================================================
# Database backup retention
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE="0 2 * * *"

# Blob storage lifecycle
BLOB_ARCHIVE_DAYS=90
BLOB_DELETE_DAYS=365

# ==============================================================================
# COMPLIANCE & AUDIT
# ==============================================================================
# Audit log settings
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=365
AUDIT_LOG_STORAGE_ACCOUNT=CHANGE_ME_AUDIT_STORAGE

# Data retention
DATA_RETENTION_DAYS=730

# ==============================================================================
# DEPLOYMENT INFO
# ==============================================================================
DEPLOYMENT_DATE=2026-01-02
DEPLOYMENT_VERSION=1.0.0
DEPLOYMENT_REGION=uksouth

# Azure App Service (if deploying to App Service)
WEBSITES_PORT=8000
WEBSITE_HTTPLOGGING_RETENTION_DAYS=7

# ==============================================================================
# HEALTH CHECKS
# ==============================================================================
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_INTERVAL=30

# ==============================================================================
# MAINTENANCE
# ==============================================================================
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="System maintenance in progress. Please try again later."
